<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>MediaTunnel | Muxable Labs</title>
    <script src="https://unpkg.com/@muxable/mediatun@0.1.3/lib/index.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/mvp.css" />
  </head>
  <body>
    <header>
      <h1>MediaTunnel: WebRTC without tears</h1>
      <p>A simple API to move audio or video from one place to another.</p>
    </header>
    <main>
      <article>
        <p>Publish something</p>
        <pre>
            <code>
const stream = await window.navigator.getUserMedia();
const id = await new MediaTunnel().publish(stream);  // this id can be used anywhere to play the media.
            </code>
        </pre>
        <script>
            function publish() {
                navigator.mediaDevices.getUserMedia({video: true, audio: true})
                    .then(function(stream) {
                        console.log('publishing');
                        return new MediaTunnel("ws://sfu.mediatun.muxable.com:7000/ws").publish(stream);
                    })
                    .then(function(id) {
                        console.log(id);
                        document.getElementById('publish-id').innerText = id;
                    });
            }
        </script>
        <a href="#" onclick="javascript:publish()"><strong>Run</strong></a>
        <p>Stream ID: <code id="publish-id"></code></p>
        <p>Then play it!</p>
        <pre>
            <code>
const stream = await new MediaTunnel().play(id);
// a convenience function to make playing a media stream easier.
await MediaTunnel.attach(document.getElementById('video'), stream);
            </code>
        </pre>
        <script>
            function play() {
                const stream = new MediaTunnel("ws://sfu.mediatun.muxable.com:7000/ws").play(document.getElementById('play-id').value);
                MediaTunnel.attach(document.getElementById('video'), stream);
            }
        </script>
        <p>Stream ID: <input type="text" id="play-id"></p>
        <a href="#" onclick="javascript:play()"><strong>Play</strong></a>
        <video id="video"></video>
        <div id="root"></div>
        <iframe src="https://forms.gle/KgfjAxiW7VhQ3umM6"></iframe>
      </article>
    </main>
  </body>
</html>
